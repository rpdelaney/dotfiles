# ~/.tmux.conf: tmux(1)
#
# global settings and key map for tmux sessions
#

#
# tmux-server configuration
#
    # don't exit just because there are no attached clients
set-option  -g      exit-unattached      off
    # lock after so many seconds of inactivity
#set  -g      lock-after-time      3600
    # shell command to execute when locking the session
set-option  -g      lock-command         ""
    # allow user to repeat hotkeys within so many milliseconds without repeating the escape sequence
set-option  -g      repeat-time          300

#
# key bindings
#
set-option  -g prefix C-a

unbind-key  Up
unbind-key  Down
unbind-key  Right
unbind-key  Left
unbind-key  C-b
bind-key    a        send-prefix
bind-key    |        split-window -c  '#{pane_current_path}' -h
bind-key    \        split-window -c  '#{pane_current_path}' -h
bind-key    -        split-window -c  '#{pane_current_path}' -v
bind-key    _        split-window -c  '#{pane_current_path}' -v
bind-key    l        next-window
bind-key    h        previous-window
#bind-key    L        last-window  # TODO: resolve the conflict between this and tmux-resurrect
bind-key    r        refresh-client\; display-message "   refresh-client"
bind-key    R        source-file ~/.config/tmux/tmux.conf\; display-message "  tmux.conf reloaded"
bind-key    n        command-prompt 'rename-window %%'
bind-key    N        command-prompt 'rename-session %%'
bind-key    *        list-clients
bind-key    y        setw synchronize-panes
bind-key    c        new-window -c ~
bind-key    x        kill-pane

# Clipboard manipulation.
# bind-key C-c run "tmux save-buffer - | xsel --input --clipboard"
# bind-key C-v run "tmux set-buffer -- \"$( xsel --output --clipboard )\"; tmux paste-buffer"

#
# clock
#
    # 24 hour clock
set-option -g clock-mode-style 24

#
# terminal features
#
    # include modifier keys in funcseqs
set-option -g xterm-keys on

set-option  -g default-terminal "tmux-256color"
# terminal-overrides "*256col*:colors=256,xterm*:XT:Ms=\E]52;%p1%s;%p2%s\007:Cs=\E]12;%p1%s\007:Cr=\E]112\007:Ss=\E[%p1%d q:Se=\E[2 q,screen*:XT"
set-option -g terminal-overrides ',tmux-256color:Tc'

    # Allow strike-through in Tmux
set-option -as terminal-overrides ',*:smxx=\E[9m'

    # Allow italics in Tmux
set-option -as terminal-overrides ',*:sitm=\E[3m'

    # set terminal title using terminfo, if found
set-option  -g set-titles on
set-option  -g set-titles-string "#T (#(hostname).#S)"
# disable \ek..\e\\

#
# mouse
#

#
# windows
#
    # start counting at 1, not 0
set-option -g     base-index          0
    # if a window closes, renumber the windows
set-option -g     renumber-windows    on
    # fit windows to screen on a per-client basis
set-option -g     aggressive-resize   on

#
# panes
#
    # time (ms) to display display-panes indicators
set-option -g display-panes-time       1000
    # start counting at 0
set-option -g pane-base-index          0
    # scrollback buffer size
set-option -g history-limit 10000

#
# status bar
#
    # time to display status-line indicators
set-option  -g display-time            1500
    # statusbar positioning (top|bottom)
set-option  -g status-position         bottom
    # how to justify the status line window list
set-option  -g status-justify          left
    # update the status line every so many seconds
set-option  -g status-interval         1
    # window status format
set-option -g window-status-format            ' #I #W #F'
    # current window status format
set-option -g window-status-current-format    ' #I #W '
    # separator between windows
set-option -g window-status-separator         ' '
   # change the color of windows that have new activity
set-option -g monitor-activity on

#
# colorschemes
#
source-file ~/.config/tmux/colorscheme.conf

#
# other behavior
#
    # list of environment variables to propagate to sessions
set-option -ga update-environment "DISPLAY SSH_AUTH_SOCK SSH_AGENT_PID SSH_TTY SSH_CONNECTION XAUTHORITY DBUS_SESSION_BUS_ADDRESS GNOME_KEYRING_CONTROL GPG_AGENT_INFO KRB5CCNAME"

    # Use vi or emacs-style key bindings in the status line, for example at the
    # command prompt.  The default is emacs, unless the VISUAL or EDITOR
    # environment variables are set and contain the string ‘vi’.
set-option -ga status-keys "vi"

# decrease command delay (increases vim responsiveness)
set-option -sg escape-time 1

#
# plugins
#

# tmux plugin manager
set-option -g @plugin 'tmux-plugins/tpm'

# load tmux-ressurect plugin
set-option -g @plugin 'tmux-plugins/tmux-resurrect'
set-option -g @resurrect-dir '$HOME/.local/share/tmux-resurrect'
set-option -g @resurrect-save 'S'
set-option -g @resurrect-restore 'L'
  # for vim
set-option -g @resurrect-strategy-vim 'session'
  # for neovim
set-option -g @resurrect-strategy-nvim 'session'

# load tmux-continuum plugin
set-option -g @plugin 'tmux-plugins/tmux-continuum'
  # automatically restore when tmux starts
set-option -g @continuum-restore 'on'
  # save every five minutes
set-option -g @continuum-save-interval '5'

# run the plugins
run-shell "$HOME"/.config/tmux/plugins/tmux-resurrect/resurrect.tmux
run-shell "$HOME"/.config/tmux/plugins/tmux-continuum/continuum.tmux

# remain on exit until the interactive shell says otherwise
# this helps debugging
set-option -g remain-on-exit on

# vim: ft=tmux wrap:
